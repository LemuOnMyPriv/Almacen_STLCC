@page "{id:int}"
@model Almacen_STLCC.Pages.Actas.RequisicionesModel
@{
    ViewData["Title"] = $"Requisiciones del Acta {Model.Acta.Numero_Acta}";
}
<link rel="stylesheet" href="~/css/actas/requisiciones.css" />

<div class="contenedor">
    <header class="header">
        <div>
            <h1><i class="fa-solid fa-file-lines"></i> Requisiciones del Acta</h1>
            <p>Numero de Acta: <strong>@Model.Acta.Numero_Acta</strong> | Proveedor: <strong>@Model.Acta.Proveedor.Nombre_Proveedor</strong></p>
        </div>
        <a asp-page="/Actas/Detalles" asp-route-id="@Model.Acta.Id_Acta" class="btn-gradient-secondary">
            <i class="fa-solid fa-angle-left"></i> Volver al Acta
        </a>
    </header>

    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert-danger">
            <i class="fa-solid fa-triangle-exclamation"></i> @Model.ErrorMessage
        </div>
    }

    @if (TempData["SuccessMessage"] != null)
    {
        <div id="successMessage" data-message="@TempData["SuccessMessage"]" style="display:none;"></div>
    }

    <section class="seccion-agregar">
        <h2>Agregar Nueva Requisición</h2>
        <form method="post" asp-page-handler="Agregar" asp-route-id="@Model.Acta.Id_Acta" class="form-agregar">
            <div class="form-group requisicion-inline">
                <div class="requisicion-field">
                    <label asp-for="Input.Requisicion">Requisición:</label>

                    <div class="requisicion-control">
                        <input asp-for="Input.Requisicion"
                               class="form-control"
                               placeholder="Ej: REQ-2025-001"
                               autocomplete="off"
                               autofocus />

                        <button type="submit" class="btn-gradient-info">
                            <i class="fa-solid fa-circle-plus"></i> Agregar Requisición
                        </button>
                    </div>

                    <span asp-validation-for="Input.Requisicion" class="text-danger"></span>
                </div>
            </div>
        </form>
    </section>

    <section class="seccion-lista">
        <h2>Requisiciones Registradas (@Model.Requisiciones.Count)</h2>

        @if (Model.Requisiciones.Any())
        {
            <div class="lista-requisiciones">
                @foreach (var req in Model.Requisiciones)
                {
                    <div class="requisicion-card">
                        <div class="requisicion-icono">
                            <i class="fa-solid fa-file-lines"></i>
                        </div>
                        <div class="requisicion-texto">
                            <strong>@req.Requisicion</strong>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="mensaje-vacio">
                <i class="fa-regular fa-folder-open"></i>
                <p>No hay requisiciones registradas para esta acta</p>
                <p class="texto-ayuda">Utilice el formulario de arriba para agregar la primera requisición</p>
            </div>
        }
    </section>
</div>

@section Scripts {
    <script src="~/js/actas/requisiciones.js"></script>
}